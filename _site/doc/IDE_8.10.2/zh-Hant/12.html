<!DOCTYPE html>
<html lang="zh_TW"><head>
  <meta charset="utf-8">
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>IDE操作手冊 12 資料交易 | 如如-智慧軟體機器人</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="IDE操作手冊 12 資料交易" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="一個基於系統需求規格進行系統自動化產生平台，解決企業軟體長期發展需求。" />
<meta property="og:description" content="一個基於系統需求規格進行系統自動化產生平台，解決企業軟體長期發展需求。" />
<link rel="canonical" href="https://docs.arcare-robot.com//doc/IDE_8.10.2/zh-Hant/12.html" />
<meta property="og:url" content="https://docs.arcare-robot.com//doc/IDE_8.10.2/zh-Hant/12.html" />
<meta property="og:site_name" content="如如-智慧軟體機器人" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-16T09:10:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="IDE操作手冊 12 資料交易" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"IDE操作手冊 12 資料交易","dateModified":"2022-02-16T09:10:00+08:00","url":"https://docs.arcare-robot.com//doc/IDE_8.10.2/zh-Hant/12.html","datePublished":"2022-02-16T09:10:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.arcare-robot.com//doc/IDE_8.10.2/zh-Hant/12.html"},"description":"一個基於系統需求規格進行系統自動化產生平台，解決企業軟體長期發展需求。","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://docs.arcare-robot.com//feed.xml" title="如如-智慧軟體機器人" /><!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W6J98QS');</script>
    <!-- End Google Tag Manager -->
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">
      <img src="/img/robotcolor.png" style="width: 40px; height: 40px; padding-right: 5px;" >如如-智慧軟體機器人
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/HOWTO/README.html">問答集</a><a class="page-link" href="/RELEASE/README.html">產品清單</a><a class="page-link" href="/INSTALLS/README.html">安裝說明</a><a class="page-link" href="/library/README.html">線上說明</a><a class="page-link" href="/about/">關於</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">IDE操作手冊 12 資料交易</h1>
  </header>

  <div class="post-content">
    <h1 id="摘要說明">摘要說明</h1>
<p>對於較複雜的資料庫更新作業，不是系統的標準新增/新增存回，修改/修改存回所能滿足時，設計者必須另外撰寫資料庫更新的處理條件與邏輯。</p>

<p>資料交易操作包含以下項目：<br /></p>
<ul>
  <li><a href="#Posting"><strong>12.1 新增資料交易</strong> </a></li>
  <li><a href="#PostingTool"><strong>12.2 資料交易工具列</strong> </a></li>
  <li><a href="#Posting_BasicSet"><strong>12.3 基本設定</strong> </a></li>
  <li><a href="#Posting_DestinationTable"><strong>12.4 目的表格</strong> </a></li>
  <li><a href="#Posting_DestinationField"><strong>12.5 目的欄位</strong> </a></li>
  <li><a href="#Posting_DataLock"><strong>12.6 資料鎖定</strong> </a></li>
  <li><a href="#Posting_AssociatedLoop"><strong>12.7 迴圈關聯</strong> </a></li>
  <li><a href="#Posting_ReceiveParameter"><strong>12.8 接收參數</strong> </a></li>
  <li><a href="#Posting_Copy"><strong>12.A 資料交易_段落複製</strong> </a></li>
  <li><a href="#Posting_Struct"><strong>12.B 資料交易迴圈運作架構及案例說明</strong> </a></li>
</ul>

<p>##流程架構
<img src="images/12.0.png" alt="" /></p>

<h2 id="Posting"><strong>12.1 新增資料交易</strong></h2>
<p>參考資料： <a href="pdf/10-1建立資料交易及參數設定.pdf" target="_blank">℗文件</a></p>

<p><img src="images/12.1-1.png" alt="" /></p>
<ol>
  <li>開啟架構樹下「資料表格」節點，駐留 DB04.資料交易。</li>
  <li>滑鼠右鍵，彈出選單，點選「新增資料交易」開啟【新增資料交易】頁面</li>
  <li>資料交易名稱：此名稱是SD在專案發展時的資源resource名稱。</li>
  <li>設定完畢後，按儲存，則此記錄新增完成。</li>
  <li>新增後，系統會開啟明細畫面進行的細部定義工作。</li>
</ol>

<p>操作說明如下</p>

<p>可單擊資料表格節點後彈出【資料交易】頁面
<img src="images/12.1-2.png" alt="" /></p>

<h2 id="PostingTool"><strong>12.2 資料交易工具列</strong></h2>

<p><img src="images/12.2-1.png" alt="" /></p>
<ol>
  <li>以輸入關鍵字方式，搜尋內容</li>
  <li>新增鍵：新增一個過帳，在編輯區出現新增資料交易項目（同12.1)。</li>
  <li>清單：以雙擊方式開啟資料交易內容，並以頁籤方式同時開啟多個交易。</li>
  <li>修改鍵：異動資料交易名稱。</li>
  <li>儲存鍵：在編修狀態下，把異動後記錄存回</li>
  <li>刪除鍵：刪除駐留資料交易。</li>
  <li>複製鍵：可利用本按鍵開啟<a href="#Posting_Copy">【資料交易加註複製】</a>指定複製的來源段落及替代內容。操作方式請參考［12.A］</li>
  <li>檢錯鍵：檢查駐留的資料交易格內容是否符合設定。當有異常時，會提示錯誤內容。</li>
  <li>規格描述：開啟<a href="06.html#SpecificationAnnotated">【規格描述】</a>說明及述敘此表格的相關事項。操作方式請參考［19.2.4 規格描述］</li>
</ol>

<h2 id="Posting_BasicSet"><strong>12.3 基本設定</strong></h2>
<blockquote>
  <p>作業目的：執行資料交易時，需設定資料從哪裡來、有無參數、以及要寫入哪些資料表。</p>
</blockquote>

<p>參考資料：</p>
<ul>
  <li><a href="pdf/10-2-1資料交易-無檢視表段落設定.pdf" target="_blank">℗無檢視表段落設定</a></li>
  <li><a href="pdf/10-2-2資料交易-有檢視表段落設定.pdf" target="_blank">℗有檢視表段落設定</a></li>
</ul>

<h3 id="1231-新增段落"><strong>12.3.1 新增段落</strong></h3>
<blockquote>
  <p>段落的定義：一個資料交易可以處理多個段落；一個段落是一個來源處理多個目的表格。</p>
</blockquote>

<p><img src="images/12.3.1-1.png" alt="" /></p>
<ol>
  <li>資料交易處理清單：此處顯示要處理資料異動的段落及目的項目，要設定段落時，必須空白無資料或是駐留段落節點時，才有效</li>
  <li>基本設定：駐留在本頁籤下，設定段落的內容</li>
  <li>新增鍵：點選本鍵，進入新增狀態</li>
  <li>段落名稱：輸入可說明本段落作業目的敍述說明</li>
  <li>來源類別＿無：選擇本項，表示此段落無資料表格當來源，異動時僅以參數或固定值處理</li>
  <li>來源類別＿檢視表：選擇本項，表示此段落由指定的檢視表當來源</li>
  <li>來源檢視表：依查表來源，開窗挑選指定檢視表格名稱</li>
  <li>清除檢視表鍵：利用本鍵清除原指定的檢視表名稱</li>
  <li>參數鍵：依該檢視表是否有定義接收參數，而點選本鍵開啟<a href="20.html#PassParameters">【傳遞參數】</a>，操作說明請參考［附錄A4］</li>
  <li>清除參數鍵：利用本鍵清除原指定的檢視表的參數</li>
  <li>過濾鍵：可利用本鍵, 開啟<a href="20.html#ConditionStatement">【條件式】</a>中, 指定表格來源記錄的符合條件內容</li>
  <li>清除鍵：利用本鍵清除原指定的條件式</li>
  <li>來源排序：若本要指定來源檢視表依據特定的排序呈現時，在本表格設定相關資訊</li>
  <li>欄位名稱：開窗挑選指定的來源檢視表格的欄位清單</li>
  <li>排序方式：下拉挑選升冪(由小到大排)/降冪(由大到小排列)</li>
  <li>排序增加鍵：增加排序的項目</li>
  <li>排序刪除鍵：刪除排序的項目</li>
  <li>排序上移鍵：駐留資料列往上移動</li>
  <li>排序下移鍵：駐留資料列往下移動</li>
  <li>來源類別＿固定筆數：選擇本項，表示此段落由指定的筆數當執行的次數</li>
  <li>起始值：指定執行次數的起始值，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位給值的依據</li>
  <li>終止值：指定執行次數的結束值，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位給值的依據</li>
  <li>累加值：指定執行次數每次累加的數值，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位給值的依據</li>
  <li>儲存鍵：點選本鍵，把異動後的資料存回資料庫</li>
</ol>

<h3 id="1232-段落其它功能"><strong>12.3.2 段落其它功能</strong></h3>
<p>作業目的：本作業介紹如何段落的其它作業項目，包括刪除、移動順序。</p>

<p><img src="images/12.3.2-1.png" alt="" /></p>
<ol>
  <li>資料交易處理清單：要刪除段落時，必須駐留該段落節點時，才有效</li>
  <li>基本設定：駐留在本頁籤下，設定段落的內容</li>
  <li>刪除鍵：點選本鍵，刪除駐留的段落，系統會再次提示訊息要求確認</li>
  <li>段落順序上移鍵：段落的執行序號，由系統依建立的順序自動產生，若需要調整時可點選本鍵將順序上移，執行序會重編</li>
  <li>段落順序下移鍵：可點選本鍵將順序上移，執行序會重編</li>
</ol>

<h2 id="Posting_DestinationTable"><strong>12.4 目的表格</strong></h2>
<blockquote>
  <p>作業目的：執行資料庫資料交易時，需設定寫入哪些資料表、用什麼方式寫入。
異動目的資料表，可依歸屬的段落所指定的資料來源筆數而異動若干筆的目的記錄。本作業介紹如何新增及設定目的資料表。</p>
</blockquote>

<p><img src="images/12.4-1.png" alt="" /></p>
<ol>
  <li>處理清單：此處顯示要處理資料異動的段落及目的項目，要新增目的表格時時，必須是駐留段落節點時，或目的表格才有效果</li>
  <li>目的表格：駐留在本頁籤下，設定目的表格的內容</li>
  <li>新增鍵：點選本鍵，進入新增狀態</li>
  <li>目的類型：下拉: 專案資料表/系統通行碼，預設為專案資料表</li>
  <li>目的表格：當目的表格類型＝專案資料表時，本欄位開窗挑選指定要異動的資料表格名稱；若為表格類型＝系統通行碼，則清空不輸入。</li>
  <li>表格別名：同一段落，多個目的表格時以代號區分，同一段落代號不可重複</li>
  <li>異動方式：選擇對目的表格記錄的異動方式，下拉：無條件新增／條件成立修改, 不成立新增／修件成立保留, 不成立新增／條件成立刪除；若為表格類型＝系統通行碼，則限定為「條件成立刪除」</li>
  <li>同步批號：當不同段落間，有需要資料延續使用時，可設定為同一批號</li>
  <li>判斷條件：當異動類別中, 有條件者, 必須指定條件項目</li>
  <li>比對欄位：開窗挑選來源目的表格的欄位, 作為與來源比對的依據</li>
  <li>類別：下拉挑選類別，下拉：參數/來源/系統值/固定值/運算式</li>
  <li>來源欄位：類別=參數： 開窗選擇過帳的參數項目<br />
類別=來源： 開窗挑選來源檢視表格的欄位<br />
類別=系統資訊：下拉: 系統日期/系統日期時間/唯一序號碼/使用者姓名/使用者帳號/使用者序號/簽入公司序號<br />
類別=固定值: 由使用者自行輸入<br />
類別=運算式: 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定內容<br /></li>
  <li>新增條件項目鍵：新增比對欄位</li>
  <li>刪除條件項目鍵：刪除比對條件</li>
  <li>儲存鍵：點選本鍵，把異動後的資料存回資料庫</li>
</ol>

<h2 id="Posting_DestinationField"><strong>12.5 目的欄位</strong></h2>
<blockquote>
  <p>作業目的：執行資料庫資料交易時，要影響那些欄位、給值內容等設定。依資料交易的需求指定要異動目的表格的欄位給值方式及內容。</p>
</blockquote>

<p><img src="images/12.5-1.png" alt="" /></p>
<ol>
  <li>資料交易處理清單：此處顯示要處理資料異動的段落及目的項目，要異動目的表格時，必須是駐留目的表格才有效果</li>
  <li>目的欄位：駐留在本頁籤下，設定目的欄位的內容</li>
  <li>新增鍵：點選本鍵，進入新增狀態</li>
  <li>影響欄位：要異動的目的欄位，挑選目的表格的目的欄位</li>
  <li>加密欄位：顯示本欄位在資料表上是否為資料加密型態的欄位。此勾選影響對應的來源欄位必須是加密或解密型態的資料欄位</li>
  <li>給值條件：當給值的內容會因為條件的不同而有異差，可利用開窗鍵, 開啟開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式，作為判斷目的欄位給值的條件，操作說明請參考［附錄A2］</li>
  <li>給值方式_固定給值鍵：選擇本項，表示此欄位的給值，有固定的來源對應</li>
  <li>固定給值類別：指定給值=取得序號，請參考註解Ａ</li>
  <li>給值方式_運算給值：選擇本項，表示此欄位的以運算式給值</li>
  <li>運算給值內容：可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為目的欄位給值的內容</li>
  <li>給值方式_多語詞庫：選擇本項，表示此欄位的以內容是給一多語詞庫料號</li>
  <li>多語詞庫：可利用開窗鍵開啟<a href="16.html#MaintainMultilingual">【多語詞庫】</a>指定挑選詞庫來指定目的欄位的內容，操作方法請參考［16.2］</li>
  <li>給值方式_重新編碼：選擇本項，表示此欄位須重新編碼</li>
  <li>重新編碼：指定編碼的型態，下拉：單據編碼/流水序號/項目/取得序號, 內容請參考註解Ｂ</li>
  <li>套用取號：選擇本項，表示套用其它段落或目的欄位取到的欄位值</li>
  <li>給值方式_條件取號：指定套用編碼的型態，下拉：單據編碼/流水序號/項目/取得序號，內容參考註解Ｃ</li>
  <li>條件取號：選擇本項，表示必須在符合條件的情況下，才取編號</li>
  <li>條件取號＿成立鍵值：選擇本項，表示必須在符合條件的情況下，才取編號</li>
  <li>條件取號＿不成立給值：可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為判斷條件成立的鍵值</li>
  <li>給值方式_預設空值：選擇本項，表示依據目的欄位的型態給空白值或０</li>
  <li>特定處理＿選項：當以上各給值方式給了目的欄位對應後，配合案例的運作有其它特別處理的應用時，可下拉：無／累加／累減／檔名／檔案／加密<br />
　累加：在同一個段落裡，對同一筆記錄的目的欄位進行累加的動作<br />
　累減：在同一個段落裡，對同一筆記錄的目的欄位進行累減的動作<br />
　檔名：給值的內容是一已上傳的二進位檔案內容，目的欄位要取的是檔案的名稱<br />
　檔案：給值的內容是一已上傳的二進位檔案內容，目的欄位要取的是檔案的內容<br /></li>
  <li>回傳參數否：當設定特定處理＝累加或累減時，必須指定目的欄位的計算方式由初始值開始：表示由０累算對應的欄位給值內容，沿用目的欄位原值：表示由目的欄位一開始取得的原則累算對應的欄位給值內容</li>
  <li>回傳參數：勾選者，表示將本目的欄位處理後的內容值，做為回傳參數的一項</li>
  <li>回傳參數＿傳遞參數：在勾選回傳參數時，指定目的欄位內容值要對應要參數的那一個變數</li>
  <li>儲存鍵：點選本鍵，把異動後的資料存回資料庫</li>
  <li>自動載入鍵：載入指定的目的表格所有欄位, 並依來源, 參數進行名稱比對, 同名者, 以指定方式自動對應</li>
</ol>

<p><strong>註解A</strong>
參考資料： <a href="pdf/10-3-1資料交易-固定給值.pdf" target="_blank">℗固定給值</a></p>

<p><img src="images/12.5-a.png" alt="" /></p>

<p>a1. 固定_系統資訊：下拉：系統日期/系統日期時間/唯一序號碼/使用者姓名/使用者帳號/使用者序號/簽入公司序號<br />
a2. 固定_接收參數：選擇來自[接收參數]的參數名稱<br />
a3. 固定_來源欄位：選擇來源表格的欄位清單 <br />
a4. 固定_序號欄位：選擇目的序號欄位<br />
a5. 固定_序號表格：選擇來源資料表格<br />
a6. 固定_序號鍵值：選擇來源資料表格的鍵值<br /></p>

<p><strong>註解B</strong>
參考資料：</p>
<ul>
  <li><a href="pdf/10-3-4資料交易-單號編碼.pdf" target="_blank">℗單號編碼</a></li>
  <li><a href="pdf/10-3-5資料交易-流水序號.pdf" target="_blank">℗流水序號</a></li>
  <li><a href="pdf/10-3-6資料交易-項次.pdf" target="_blank">℗項次</a></li>
</ul>

<p><img src="images/12.5-b.png" alt="" /></p>

<p>b1. 設定_表單名：指定參考套用編碼的表單<br />
b2. 設定_元件名：指定參考套用編碼的元件<br />
b3. 編碼＿鍵值：若同時產生多筆記錄, 而有不同編碼產出時, 可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位辨視的條件<br />
b4. 清除編碼鍵值鍵：清除已設定的運算式<br />
b5. 流水號＿固定起始值：型態=流水序號，選擇本項，表示由固定號碼開始往下編<br />
b6. 流水號＿參照起始值：型態=流水序號， 選擇本項，表示由指定的參照欄位內容往下編，指定的起始的參考欄位<br />
b7. 流水號＿鍵值：若同時產生多筆記錄, 而有不的號碼產出時, 可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位辨視的條件<br />
b8. 清除流水號鍵值鍵：清除已設定的運算式<br />
b9. 項次＿固定起始值：型態=流水序號，選擇本項，表示由固定號碼開始往下編<br />
b10. 項次＿參照值：指定的起始的參考欄位<br />
b11. 項次＿鍵值：若同時產生多筆記錄, 而有不的號碼產出時, 可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位辨視的條件<br />
b12. 清除項目鍵值鍵：清除已設定的運算式<br />
b13. 取得序號＿鍵值：若同時產生多筆記錄, 而有不的號碼產出時, 可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為欄位辨視的條件<br />
b14. 清除取得序號鍵值鍵：清除已設定的運算式<br /></p>

<p><strong>註解C</strong>
參考資料：</p>
<ul>
  <li><a href="pdf/10-3-7資料交易-套用取號.pdf" target="_blank">℗套用取號</a></li>
  <li><a href="pdf/10-3-8資料交易-條件取號.pdf" target="_blank">℗條件取號</a></li>
</ul>

<p><img src="images/12.5-c.png" alt="" /></p>

<p>c1. 套用取號＿鍵值：設定組合運算式, 作為目的欄位取號判斷的依據，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定 <br />
c2. 流水序號_鍵值：設定組合運算式, 作為目的欄位取號判斷的依據，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a> <br />
c3. 項次_鍵值：設定組合運算式, 作為目的欄位取號判斷的依據，可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a><br />
c4. 取得序號_表格：選擇來源資料表格<br />
c5. 取得序號_欄位：選擇來源資料表格的欄位<br />
c6. 取得序號_鍵值：設定組合運算式, 作為來源資料表格的鍵值依據，開啟<a href="20.html#ExpressionStatement">【運算式】</a><br /></p>

<p><strong>其它</strong>
參考資料：</p>
<ul>
  <li><a href="pdf/10-3-2資料交易-運算給值.pdf" target="_blank">℗運算給值</a></li>
  <li><a href="pdf/10-3-3資料交易-多語詞庫.pdf" target="_blank">℗多語詞庫</a></li>
  <li><a href="pdf/10-3-9資料交易-預設清空.pdf" target="_blank">℗預設清空</a></li>
  <li><a href="pdf/10-3-10資料交易-特定處理.pdf" target="_blank">℗特定處理</a></li>
</ul>

<h2 id="Posting_DataLock"><strong>12.6 資料鎖定</strong></h2>
<blockquote>
  <p>作業目的：執行資料庫資料交易時，為避免多人同時存取同一筆記錄，進行資料異動或計算時，發生重疊的狀況，所以必須宣告記錄使用前的鎖定條件及內容。</p>
</blockquote>

<p>參考資料： <a href="pdf/10-3-11資料交易-資料鎖定.pdf" target="_blank">℗資料鎖定</a></p>

<p><img src="images/12.6-1.png" alt="" /></p>
<ol>
  <li>資料交易處理清單：駐留要增加資料鎖定的段落</li>
  <li>資料鎖定：駐留在本頁籤下，設定鎖定的內容</li>
  <li>新增鍵：點選本鍵，進入新增狀態</li>
  <li>鎖定表格：開窗挑選指定要異動的資料表格名稱，同一段落內不允重複</li>
  <li>比對欄位：開窗挑選來源目的表格的欄位, 作為與來源比對的依據</li>
  <li>類別：下拉挑選類別，下拉：來源/系統值/固定值</li>
  <li>來源欄位：類別=來源： 開窗挑選來源檢視表格的欄位<br />
類別=系統資訊：下拉: 使用者姓名/使用者帳號/使用者序號/簽入公司序號<br />
類別=固定值: 由使用者自行輸入<br /></li>
  <li>新增條件項目鍵：新增比對欄位</li>
  <li>刪除條件項目鍵：刪除比對條件</li>
  <li>儲存鍵：點選本鍵，把異動後的資料存回資料庫</li>
</ol>

<h2 id="Posting_AssociatedLoop"><strong>12.7 迴圈關聯</strong></h2>
<blockquote>
  <p>作業目的：有的工作需進行自動的數量分配，以免使用者手工指定數量既耗時又容易出錯，迴圈功能可達到此效果。</p>
</blockquote>

<p>參考資料： <a href="pdf/10-4迴圈關聯.pdf" target="_blank">℗文件</a></p>

<p><img src="images/12.7-1.png" alt="" /></p>
<ol>
  <li>資料交易處理清單：駐留要增加資料鎖定的段落</li>
  <li>資料鎖定：駐留在本頁籤下，設定鎖定的內容</li>
  <li>新增鍵：點選本鍵，進入新增狀態</li>
  <li>巢狀迴圈：勾選本項，表示另一個段落當外圈進行巢狀的遞迴</li>
  <li>巢狀上層：下拉挑選駐留筆以上的段落編號</li>
  <li>巢狀上層段落：顯示指定當迴圈的的段落名稱</li>
  <li>迴圈過濾：指定上層段落的資料要進入本段落計算的條件邏輯</li>
  <li>邏輯：下拉指定，AND/OR</li>
  <li>欄位名：挑選本段落欄位</li>
  <li>判斷式：下拉指定，大於/小於/等於…等等運算子</li>
  <li>類別：下拉指定，來源/固定值</li>
  <li>上層欄位/固定值：依指定的類別給值<br />
類別＝來源：開窗挑選上層段落的來源表格欄位<br />
類別=固定值：自行輸入<br /></li>
  <li>新增過濾項目鍵：新增迴圈過濾的資料列</li>
  <li>刪除過濾項目鍵：刪除迴圈過濾的資料列</li>
  <li>迴圈判斷：指定本階段落的資料要繼續執行的條件邏輯</li>
  <li>邏輯：下拉指定，AND/OR</li>
  <li>段落項次：可選擇要設定的段落項次</li>
  <li>欄位：開窗段落的來源表格欄位名稱</li>
  <li>判斷式：下拉：大於/小於/等於…等等運算子</li>
  <li>類別：下拉：來源/固定值</li>
  <li>欄位名/固定值鍵：依指定的類別給值<br />
類別＝來源：開窗挑選本層段落的來源表格欄位<br />
類別=固定值：自行輸入<br /></li>
  <li>新增過濾項目鍵：新增迴圈判斷的資料列</li>
  <li>刪除過濾項目鍵：刪除迴圈判斷的資料列</li>
  <li>迴圈條件異動：指定本階段落的對記錄欄位要異動的內容</li>
  <li>段落項次：挑選段落項次</li>
  <li>變動欄位：開窗挑選段落中的來源欄位</li>
  <li>給值條件：可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為關聯欄位給值條件的依據</li>
  <li>運算內容：可利用開窗鍵, 開啟<a href="20.html#ExpressionStatement">【運算式】</a>設定組合運算式, 作為關聯欄位給值的內容</li>
  <li>新增異動項目鍵：新增迴圈判斷的資料列</li>
  <li>刪除異動項目鍵：刪除迴圈判斷的資料列</li>
  <li>儲存鍵：點選本鍵，把異動後的資料存回資料庫</li>
</ol>

<h2 id="Posting_ReceiveParameter"><strong>12.8 接收參數</strong></h2>
<blockquote>
  <p>作業目的：設定執行本資料交易時，必須傳入的參數內容</p>
</blockquote>

<p><img src="images/12.8-1.png" alt="" /></p>
<ol>
  <li>接收參數：駐留在本頁籤下，設定參數的內容</li>
  <li>修改鍵：點選本鍵，進入編修模式</li>
  <li>接收參數表格：用於記錄由前單傳入的參數</li>
  <li>新增鍵：點選 + 新增鍵新增檢視表的初始記錄。</li>
  <li>參數名：輸入本筆資料欄位要接收的變數名。</li>
  <li>型態：下拉挑選, 型態:文字/數字/日期</li>
  <li>說明：輸入參數用途</li>
  <li>刪除參數項目鍵：刪除參數資料列</li>
  <li>回傳參數表格：用於表列由本單產生的資料要回應給呼叫端</li>
  <li>參數名：輸入本筆資料欄位要回傳的變數名。</li>
  <li>型態：下拉挑選, 型態:文字/數字/日期</li>
  <li>多筆否：勾選時，表示回傳的資料是多筆。這部份用於外部呼叫按鍵者才有效用。</li>
  <li>說明：輸入參數用途</li>
  <li>儲存鍵：將異動的參數內容進行儲存。</li>
</ol>

<h2 id="Posting_Copy"><strong>附錄 12.A 資料交易加註複製</strong></h2>
<blockquote>
  <p>作業目的：利用本功能複製已存在的其它交易的段落</p>
</blockquote>

<p><img src="images/12.A-1.png" alt="" /></p>

<ol>
  <li>目的過帳：顯示啟動本作業的過帳名名稱</li>
  <li>來源過帳：挑選指定要複製的段落所在的過帳名稱</li>
  <li>來源段落：挑選指定要複製的段落名稱</li>
  <li>載入鍵：點選本鍵時，會把來源段落內容的變數項目載入替代內容表格中</li>
  <li>原使用參數名稱：顯示應來源的內容使用到的相關單元名稱</li>
  <li>替換參數名稱：依應來源參數原先定義的類型，挑選指定要替代的內容</li>
  <li>同名對應鍵：利用本按鍵，依替代表格內所出現的原使用名稱，找到本表單內有相同類型、相同名稱者進行對應，減少用戶挑選的時間</li>
  <li>執行鍵：點選按鍵，把已指定好的規格項目及替代內容，替換掉原本段落定義</li>
</ol>

<h2 id="Posting_Struct"><strong>附錄 12.B 資料交易迴圈運作架構及案例說明</strong></h2>
<p><img src="images/B.1-0.png" alt="" /></p>

<blockquote>
  <p>案例說明</p>
</blockquote>

<p><img src="images/B.1-1.png" alt="" /></p>

<p><img src="images/B.1-2.png" alt="" /></p>

<hr />
<p><a href="index.html#MainMenu"><strong>回到章節目錄</strong></a></p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>一個基於系統需求規格進行系統自動化產生平台，解決企業軟體長期發展需求。</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W6J98QS"
      height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

  </body>

</html>
